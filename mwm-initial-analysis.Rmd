---
title: "MWM Analysis"
author: "Anna MacFarlane"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

library(tidyverse)
library(cowplot)

info<-read.csv("apoe22_33_44__2HN_3HN_4HN_mwm_combined copy.csv", header=TRUE)

test<-info %>% 
  filter(Sex != "FHet") %>% 
  filter(Stage != "Probe_D5" | Stage != "Probe_D8") %>% 
  # aesthetic purposes:
  mutate(Stage = case_when( 
    Stage == "Day1" ~ "Day 1",
    Stage == "Day2" ~ "Day 2",
    Stage == "Day3" ~ "Day 3",
    Stage == "Day4" ~ "Day 4",
    Stage == "Day5" ~ "Day 5"
  )) %>% 
  filter(! is.na(Stage)) %>% 
  mutate(Sex = case_when(
    Sex == "F" ~ "Female",
    Sex == "M" ~ "Male"
  )) %>% 
  group_by(Animal, Stage, add = TRUE) %>% 
  #group_by(Stage) %>% 
  summarize(
    Duration = mean(Duration),
    Distance = mean(Distance)
  )

reg_trials<-info %>% 
  filter(Sex != "FHet") %>% 
  filter(Stage != "Probe_D5" | Stage != "Probe_D8") %>% 
  # aesthetic purposes:
  mutate(Day = case_when( 
    Stage == "Day1" ~ 1,
    Stage == "Day2" ~ 2,
    Stage == "Day3" ~ 3,
    Stage == "Day4" ~ 4,
    Stage == "Day5" ~ 5
  )) %>% 
  filter(! is.na(Day)) %>% 
  mutate(Sex = case_when(
    Sex == "F" ~ "Female",
    Sex == "M" ~ "Male"
  )) 
reg_trials
hn_trials <- reg_trials %>% 
  filter(APOE == "E2HN" | APOE == "E3HN" | APOE == "E4HN")

e_trials <- reg_trials %>% 
  filter(APOE == "E22" | APOE == "E33" | APOE == "E44")
```

```{r andrei-plots, message = FALSE}
ggline(reg_trials, x='Stage', y='Duration', color='APOE', fill='APOE',
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red','pink','gray','blue', 'orange'), size=1,
       point.size=1.5, xlab='', ylab='Time to Platform (s)', legend='top')

ggline(reg_trials, x='Stage', y='SW.time', color='APOE', fill='APOE',
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red','pink','gray','blue', 'orange'), size=1,
       point.size=1.5, xlab='', ylab='SW Time', legend='top')

ggline(reg_trials, x='Stage', y='SW.distance', color='APOE', fill='APOE',
       error.plot='errorbar', add='mean_se', palette = c('blueviolet', 'chartreuse1', 'red','pink','gray','blue', 'orange'), size=1,
       point.size=1.5, xlab='', ylab='DW Distance', legend='top')
```
ggplot(reg_trials, aes(Day, Duration, 
                 color = APOE, fill = APOE)) +
  geom_boxplot() +
  theme_bw() +
  labs(title = "MWM Duration - all genotypes",
       subtitle = "Males and females")
       
```{r duration, message = FALSE}

plot1<-ggplot(reg_trials, aes(Day, Duration, 
                 color = APOE, fill = APOE)) +
  geom_jitter(size = .5) +
  theme_bw() +
  labs(title = "MWM Duration - all genotypes",
       subtitle = "Males and females")

plot2<-ggplot(reg_trials, aes(Day, Duration, 
                 color = APOE, fill = APOE)) +
  geom_jitter(size = .5) +
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(hn_trials, aes(Day, Duration, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
  theme_bw() +
  labs(title = "MWM Duration - HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(hn_trials, aes(Day, Duration, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(e_trials, aes(Day, Duration, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "MWM Duration - non-HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(e_trials, aes(Day, Duration, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 
```


```{r sw-distance, message = FALSE}
plot1<-ggplot(reg_trials, aes(Day, SW.distance, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "SW Distance - all genotypes",
       subtitle = "Males and females")

plot2<-ggplot(reg_trials, aes(Day, SW.distance, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(hn_trials, aes(Day, SW.distance, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "SW Distance - HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(hn_trials, aes(Day, SW.distance, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(e_trials, aes(Day, SW.distance, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "SW Distance - non-HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(e_trials, aes(Day, SW.distance, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 
```

```{r norm-sw-distance, message = FALSE}
plot1<-ggplot(reg_trials, aes(Day, NormSWDist, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "Normalized SW Distance - all genotypes",
       subtitle = "Males and females")

plot2<-ggplot(reg_trials, aes(Day, NormSWDist, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(hn_trials, aes(Day, NormSWDist, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "Normalized SW Distance - HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(hn_trials, aes(Day, NormSWDist, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(e_trials, aes(Day, NormSWDist, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "Normalized SW Distance - non-HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(e_trials, aes(Day, NormSWDist, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 
```

```{r sw-time, message = FALSE}
plot1<-ggplot(reg_trials, aes(Day, SW.time, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "SW Time - all genotypes",
       subtitle = "Males and females")

plot2<-ggplot(reg_trials, aes(Day, SW.time, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(hn_trials, aes(Day, SW.time, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "SW Time - HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(hn_trials, aes(Day, SW.time, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(e_trials, aes(Day, SW.time, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "SW Time - non-HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(e_trials, aes(Day, SW.time, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 
```


```{r norm-sw-time, message = FALSE}
plot1<-ggplot(reg_trials, aes(Day, NormSWTime, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "Normalized SW Time - all genotypes",
       subtitle = "Males and females")

plot2<-ggplot(reg_trials, aes(Day, NormSWTime, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(hn_trials, aes(Day, NormSWTime, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "Normalized SW Time - HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(hn_trials, aes(Day, NormSWTime, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 

plot1<-ggplot(e_trials, aes(Day, NormSWTime, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  theme_bw() +
  labs(title = "Normalized SW Time - non-HN genotypes",
       subtitle = "Males and females")

plot2<-ggplot(e_trials, aes(Day, NormSWTime, 
                 color = APOE, fill = APOE)) +
   geom_jitter(size = .5) +
   
  facet_grid(. ~ Sex) +
  theme_bw()  +
  theme(legend.position="none")

ggdraw() + 
  draw_plot(plot1, 0, .5, 1, .5) +
  draw_plot(plot2, 0, 0, 1, .5) 
```